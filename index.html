<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>≈ÅƒÖczenie s≈Ç√≥w.</title>
  <!-- LeaderLine -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leader-line/1.0.7/leader-line.min.js" defer></script>

  <style>
    /* ====== Zmienne motyw√≥w ====== */
    :root {
      /* domy≈õlnie CIEMNY (jak w Twoim kodzie) */
      --bg-start: #0b1220;
      --bg-end: #0b1220;
      --card: #111827cc;
      --text: #e5e7eb;
      --muted: #9aa3b2;
      --primary: #5b8def;
      --primary-600: #4478ec;
      --accent: #60d2c6;
      --accent-600: #43c4b5;
      --warning: #f59e0b;
      --danger: #ef4444;
      --success: #10b981;
      --pill: #1f2937;
      --pill-border: #334155;
      --line: rgba(229,231,235,.9);
      --shadow: 0 10px 30px rgba(0, 0, 0, .25);
      --radius: 18px;
      --chip-bg: #0f172a;
      --progress-bg: #0f172a;
    }

    /* Wersja JASNA ‚Äì aktywuje siƒô gdy <body data-theme="light"> */
    body[data-theme="light"] {
      --bg-start: #f7f9fc;
      --bg-end: #eef3ff;
      --card: #ffffffcc;
      --text: #1f2937;
      --muted: #6b7280;
      --primary: #5b8def;
      --primary-600: #4478ec;
      --accent: #60d2c6;
      --accent-600: #43c4b5;
      --warning: #f59e0b;
      --danger: #ef4444;
      --success: #10b981;
      --pill: #fff7d6;
      --pill-border: #c9b85a;
      --line: rgba(31,41,55,.85);
      --shadow: 0 10px 30px rgba(17,24,39,.08);
      --chip-bg: #eef2ff;
      --progress-bg: #e5e7eb;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background: linear-gradient(160deg, var(--bg-start), var(--bg-end));
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background .2s ease, color .2s ease;
    }

    .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px clamp(12px, 2vw, 32px);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin: 8px 0 16px;
      flex-wrap: wrap;
    }

    h1 {
      font-size: clamp(22px, 3vw, 32px);
      margin: 0;
      letter-spacing: 0.2px;
      color: var(--text);
    }

    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .card {
      background: var(--card);
      backdrop-filter: blur(6px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(14px, 2vw, 22px);
      border: 1px solid rgba(148, 163, 184, .18);
      transition: background .2s ease, box-shadow .2s ease, border-color .2s ease;
    }

    .instructions {
      color: var(--muted);
      font-size: clamp(14px, 1.7vw, 16px);
      margin: 6px 0 18px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
    }

    /* Mobile ‚Äì jedna kolumna, wygodne klikanie */
    @media (max-width: 700px) {
      .grid { grid-template-columns: 1fr; }
      .column { min-height: 0; }
      .footerbar { flex-direction: column; align-items: stretch; gap: 10px; }
      .progress { width: 100%; }
      .toolbar { width: 100%; justify-content: flex-start; }
    }

    .column {
      min-height: 460px;
      display: grid;
      align-content: start;
      gap: 12px;
      position: relative; /* dla linii */
      padding-bottom: 6px;
    }

    .col-title {
      font-weight: 600;
      color: var(--muted);
      letter-spacing: .3px;
      margin-bottom: 6px;
    }

    .word {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 14px 18px;
      border-radius: 999px;
      border: 2px solid var(--pill-border);
      background: var(--pill);
      user-select: none;
      cursor: pointer;
      font-weight: 700;
      letter-spacing: .2px;
      font-size: clamp(16px, 1.9vw, 20px);
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease, border-color .12s ease;
      box-shadow: 0 2px 0 rgba(0,0,0,.25);
      min-height: 52px; /* wiƒôkszy hitbox na mobile */
      color: var(--text);
    }

    .word:hover { transform: translateY(-1px); }
    .word:active { transform: translateY(0); }

    .word.selected {
      outline: 3px solid color-mix(in oklab, var(--primary) 60%, transparent);
      border-color: var(--primary);
      box-shadow: 0 6px 18px rgba(69, 108, 255, .25);
      background: var(--chip-bg);
    }

    .word.disabled {
      opacity: .6;
      cursor: not-allowed;
      filter: saturate(.85);
    }

    .inputs {
      display: grid;
      grid-template-columns: 1fr 1fr auto;
      gap: 10px;
      align-items: center;
    }

    @media (max-width: 560px) {
      .inputs { grid-template-columns: 1fr; }
      .inputs .btn { width: 100%; }
    }

    .inputs input {
      height: 46px;
      border-radius: 12px;
      border: 1px solid rgba(100,116,139,.35);
      padding: 10px 14px;
      font-size: 16px;
      background: var(--chip-bg);
      color: var(--text);
      outline: none;
      box-shadow: inset 0 1px 0 rgba(0,0,0,.25);
      transition: background .2s ease, color .2s ease, border-color .2s ease;
    }

    .btn {
      height: 46px;
      padding: 0 16px;
      border: none;
      border-radius: 12px;
      font-weight: 700;
      letter-spacing: .2px;
      cursor: pointer;
      transition: transform .1s ease, box-shadow .2s ease, background .15s ease, filter .15s;
      box-shadow: 0 6px 16px rgba(0,0,0,.25);
      color: #0b1220;
    }

    .btn:active { transform: translateY(1px); }

    .btn.primary { background: var(--primary); color: #fff; }
    .btn.primary:hover { background: var(--primary-600); }

    .btn.accent { background: var(--accent); color: #0b3b35; }
    .btn.accent:hover { background: var(--accent-600); }

    .btn.warn { background: var(--warning); color: #3b2a00; }
    .btn.warn:hover { filter: brightness(.95); }

    .btn.danger { background: var(--danger); color: #fff; }
    .btn.danger:hover { filter: brightness(.95); }

    .footerbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin-top: 16px;
    }

    .score {
      font-weight: 700;
      color: var(--muted);
    }

    .progress {
      width: 220px;
      height: 10px;
      background: var(--progress-bg);
      border-radius: 999px;
      overflow: hidden;
      box-shadow: inset 0 1px 2px rgba(0,0,0,.5);
      transition: background .2s ease;
    }

    .progress > span {
      display: block;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--primary));
      transition: width .3s ease;
    }

    .hint {
      font-size: 14px;
      color: var(--muted);
    }

    .columns-card { position: relative; isolation: isolate; }

    /* miejsce na linie (nad kartƒÖ, ale pod s≈Çowami) ‚Äì dla porzƒÖdku */
    .lines-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 0;
    }

    /* s≈Çowa powinny byƒá nad liniami */
    .columns-content { position: relative; z-index: 2; }

    /* LeaderLine ‚Äì wa≈ºne dla mobile */
    .leader-line {
      z-index: 0 !important;
      pointer-events: none !important;
      transition: opacity .15s ease;
    }
    body.hide-lines .leader-line { opacity: 0; }

    /* Notyfikacje */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translateX(-50%);
      background: #111827;
      color: #fff;
      padding: 10px 14px;
      border-radius: 10px;
      box-shadow: var(--shadow);
      opacity: 0;
      transition: opacity .2s ease, transform .2s ease;
      pointer-events: none;
      font-size: 14px;
      z-index: 50;
    }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(-4px); }

    /* Stopka z podpisem i przyciskiem GitHub */
    .site-footer {
      margin-top: 22px;
      padding: 16px;
      color: var(--muted);
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .github-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      border-radius: 999px;
      background: var(--chip-bg);
      color: var(--text);
      text-decoration: none;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(0,0,0,.35);
      transition: background .2s ease, color .2s ease, filter .15s;
    }
    .github-btn:hover { filter: brightness(1.06); }
    .github-btn svg { width: 18px; height: 18px; fill: currentColor; display: block; }

    /* ====== Prze≈ÇƒÖcznik motywu (radio) ====== */
    .theme-switch {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 6px;
      background: var(--card);
      border: 1px solid rgba(148, 163, 184, .18);
      border-radius: 999px;
      box-shadow: var(--shadow);
    }
    .theme-switch .opt {
      position: relative;
    }
    .theme-switch input {
      appearance: none;
      -webkit-appearance: none;
      width: 0;
      height: 0;
      position: absolute;
      opacity: 0;
    }
    .theme-switch label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 700;
      color: var(--muted);
      user-select: none;
      transition: background .15s ease, color .15s ease, box-shadow .15s;
    }
    .theme-switch input:checked + label {
      background: var(--accent);
      color: #0b3b35;
      box-shadow: 0 4px 12px rgba(0,0,0,.15);
    }
    .theme-dot {
      width: 10px; height: 10px; border-radius: 50%;
      background: currentColor;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>≈ÅƒÖczenie s≈Ç√≥w.</h1>
        <p class="instructions">Kliknij s≈Çowo po angielsku, a nastƒôpnie jego polski odpowiednik, aby utworzyƒá po≈ÇƒÖczenie.</p>
      </div>

      <div class="toolbar">
        <!-- Prze≈ÇƒÖcznik motywu (radio) -->
        <div class="theme-switch" role="radiogroup" aria-label="Wyb√≥r motywu">
          <div class="opt">
            <input type="radio" name="theme" id="theme-light" value="light" />
            <label for="theme-light" title="Jasny">
              <span class="theme-dot" style="color:#fbc02d"></span> Jasny
            </label>
          </div>
          <div class="opt">
            <input type="radio" name="theme" id="theme-dark" value="dark" />
            <label for="theme-dark" title="Ciemny">
              <span class="theme-dot" style="color:#94a3b8"></span> Ciemny
            </label>
          </div>
        </div>

        <button id="fullscreenBtn" class="btn accent" type="button" aria-label="Prze≈ÇƒÖcz pe≈Çny ekran">‚§¢ Pe≈Çny ekran</button>
        <button id="shuffleBtn" class="btn warn" type="button">üîÄ Mieszaj</button>
        <button id="resetBtn" class="btn danger" type="button">üîÑ Reset</button>
      </div>
    </header>

    <section class="card" style="margin-bottom:14px;">
      <div class="inputs">
        <input id="englishInput" placeholder="Angielskie s≈Çowo" autocomplete="off" />
        <input id="polishInput" placeholder="Polskie s≈Çowo" autocomplete="off" />
        <button id="addBtn" class="btn primary" type="button">‚ûï Dodaj</button>
      </div>
      <p class="hint" style="margin-top:8px;">Podpowied≈∫: dodawaj w≈Çasne pary, by rozszerzaƒá zestaw. Kliknij <strong>Sprawd≈∫</strong>, aby zobaczyƒá wynik.</p>
    </section>

    <section class="card columns-card">
      <div class="lines-layer" aria-hidden="true"></div>

      <div class="columns-content grid">
        <div>
          <div class="col-title">English</div>
          <div id="englishCol" class="column" aria-label="Angielskie s≈Çowa"></div>
        </div>
        <div>
          <div class="col-title">Polski</div>
          <div id="polishCol" class="column" aria-label="Polskie s≈Çowa"></div>
        </div>
      </div>

      <div class="footerbar">
        <div class="left" style="display:flex;gap:10px;flex-wrap:wrap;">
          <button id="checkBtn" class="btn primary" type="button">‚úÖ Sprawd≈∫ odpowiedzi</button>
          <button id="undoBtn" class="btn" type="button" style="background:var(--chip-bg);color:var(--text);">‚Ü∂ Cofnij po≈ÇƒÖczenie</button>
        </div>
        <div class="right" style="display:flex;align-items:center;gap:12px;min-width:220px;">
          <span id="scoreText" class="score">Poprawne: 0 / 0</span>
          <div class="progress" aria-hidden="true"><span id="progressBar"></span></div>
        </div>
      </div>
    </section>

    <!-- Stopka z podpisem i linkiem do GitHuba -->
    <footer class="site-footer">
      <div>
        ¬© 2025 <strong>zowlikC</strong> ‚Äî ‚ÄûAngielski dla mechanika / narzƒôdziowca (modu≈Ç osobny czƒô≈õƒá projektu SRS Fiszki)‚Äù
      </div>
      <a class="github-btn" href="https://github.com/zolwikC" target="_blank" rel="noopener">
        <svg viewBox="0 0 16 16" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8a8 8 0 0 0 5.47 7.59c.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82a7.6 7.6 0 0 1 4 0c1.53-1.03 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.28.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.45.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8Z"/></svg>
        GitHub profil
      </a>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // ====== Dane poczƒÖtkowe ======
    const initialWords = [
      { pl: "Zupa", en: "Soup" },
      { pl: "Sa≈Çatka", en: "Salad" },
      { pl: "Pizza", en: "Pizza" },
      { pl: "Kapusta", en: "Cabbage" },
      { pl: "Frytki", en: "Chips" },
      { pl: "Pulpety", en: "Meatballs" },
      { pl: "Makaron", en: "Pasta" },
      { pl: "Kurczak", en: "Chicken" },
      { pl: "Herbata", en: "Tea" },
      { pl: "≈öniadanie", en: "Breakfast" },
      { pl: "PrzekƒÖska", en: "Snack" },
      { pl: "Obiad", en: "Dinner" },
      { pl: "Lunch", en: "Lunch" }
    ];

    // ====== Stan gry ======
    let words = [...initialWords];
    let englishPool = []; // DOM elementy
    let polishPool = [];
    let selected = null;  // {el, lang, text}
    let lines = [];       // { line, fromEl, toEl, fromText, toText }

    // Blokada: jedno s≈Çowo -> max 1 po≈ÇƒÖczenie
    const usedEnglish = new WeakSet();
    const usedPolish = new WeakSet();

    const qs = (sel) => document.querySelector(sel);
    const getVar = (name) => getComputedStyle(document.body).getPropertyValue(name).trim();

    // ====== Utils ======
    function shuffle(arr){
      for(let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function toast(msg, ms = 1600){
      const t = qs('#toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), ms);
    }

    // ====== Tworzenie s≈Ç√≥w ======
    function createWordEl(text, lang){
      const el = document.createElement('button');
      el.type = 'button';
      el.className = 'word';
      el.textContent = text;
      el.setAttribute('data-lang', lang);
      el.setAttribute('aria-pressed', 'false');

      el.addEventListener('click', () => onWordClick(el, lang, text));
      return el;
    }

    function renderColumns(){
      const engCol = qs('#englishCol');
      const plCol = qs('#polishCol');
      engCol.innerHTML = '';
      plCol.innerHTML = '';

      const eng = [...words];
      const pl = [...words];
      shuffle(eng); shuffle(pl);

      englishPool = eng.map(w => createWordEl(w.en, 'en'));
      polishPool = pl.map(w => createWordEl(w.pl, 'pl'));

      englishPool.forEach(el => engCol.appendChild(el));
      polishPool.forEach(el => plCol.appendChild(el));

      // Po rerenderze trzeba przerysowaƒá linie
      removeAllLines();
      updateScore();
    }

    // ====== Logika ≈ÇƒÖczenia ======
    function onWordClick(el, lang, text){
      // zablokowane elementy (ju≈º po≈ÇƒÖczone)
      if ((lang === 'en' && usedEnglish.has(el)) || (lang === 'pl' && usedPolish.has(el))) {
        toast('To s≈Çowo ju≈º jest po≈ÇƒÖczone.');
        return;
      }

      if (!selected){
        selected = { el, lang, text };
        el.classList.add('selected');
        el.setAttribute('aria-pressed', 'true');
        return;
      }

      // Klikniƒôcie w ten sam element = anuluj wyb√≥r
      if (selected.el === el){
        el.classList.remove('selected');
        el.setAttribute('aria-pressed', 'false');
        selected = null;
        return;
      }

      // Dozwolone ≈ÇƒÖczenie tylko EN -> PL lub PL -> EN
      if (selected.lang === lang){
        // zmie≈Ñ wyb√≥r w tej samej kolumnie
        selected.el.classList.remove('selected');
        selected.el.setAttribute('aria-pressed', 'false');
        selected = { el, lang, text };
        el.classList.add('selected');
        el.setAttribute('aria-pressed', 'true');
        return;
      }

      // Utw√≥rz liniƒô
      const from = selected.lang === 'en' ? selected.el : el;
      const to   = selected.lang === 'en' ? el : selected.el;
      const fromText = (selected.lang === 'en') ? selected.text : text; // en
      const toText   = (selected.lang === 'en') ? text : selected.text; // pl

      const line = new LeaderLine(from, to, {
        color: getVar('--line') || 'rgba(229,231,235,.9)',
        size: 3,
        startPlug: 'behind',
        endPlug: 'arrow3',
        path: window.innerWidth <= 700 ? 'straight' : 'fluid', // na mobile pro≈õciej
        dropShadow: true,
        startSocket: 'right',
        endSocket: 'left',
      });

      lines.push({ line, fromEl: from, toEl: to, fromText, toText });

      // Zablokuj wykorzystane s≈Çowa
      usedEnglish.add(from);
      usedPolish.add(to);
      from.classList.add('disabled');
      to.classList.add('disabled');

      // Wyczy≈õƒá wyb√≥r
      selected.el.classList.remove('selected');
      selected.el.setAttribute('aria-pressed', 'false');
      selected = null;

      updateScore(false);
    }

    function removeAllLines(){
      lines.forEach(({ line }) => line.remove());
      lines = [];
      // odblokuj s≈Çowa
      [...englishPool, ...polishPool].forEach(el => {
        el.classList.remove('disabled', 'selected');
        el.setAttribute('aria-pressed', 'false');
      });
      // reset zestaw√≥w
      englishPool.forEach(el => usedEnglish.delete(el));
      polishPool.forEach(el => usedPolish.delete(el));
    }

    function undoLast(){
      const last = lines.pop();
      if (!last){ toast('Brak po≈ÇƒÖcze≈Ñ do cofniƒôcia.'); return; }
      last.line.remove();
      last.fromEl.classList.remove('disabled');
      last.toEl.classList.remove('disabled');
      usedEnglish.delete(last.fromEl);
      usedPolish.delete(last.toEl);
      updateScore(false);
    }

    function checkAnswers(){
      if (!lines.length){ toast('Najpierw utw√≥rz przynajmniej jedno po≈ÇƒÖczenie.'); return; }
      let correct = 0;
      lines.forEach(({ line, fromText, toText }) => {
        const ok = words.some(w => w.en === fromText && w.pl === toText);
        line.setOptions({ color: ok ? 'rgba(16,185,129,.95)' : 'rgba(239,68,68,.95)', size: 4 });
        if (ok) correct++;
      });
      updateScore(true, correct, lines.length);
    }

    function updateScore(afterCheck = false, correct = 0, total = 0){
      const scoreEl = qs('#scoreText');
      if (afterCheck) {
        scoreEl.textContent = `Poprawne: ${correct} / ${total}`;
        qs('#progressBar').style.width = total ? `${(correct / total) * 100}%` : '0%';
      } else {
        scoreEl.textContent = `Po≈ÇƒÖcze≈Ñ: ${lines.length}`;
        const denom = Math.max(words.length, 1);
        qs('#progressBar').style.width = `${(lines.length / denom) * 100}%`;
      }
    }

    function addCustomWord(){
      const en = qs('#englishInput').value.trim();
      const pl = qs('#polishInput').value.trim();
      if (!en || !pl){ toast('Uzupe≈Çnij oba pola.'); return; }
      if (words.some(w => w.en.toLowerCase() === en.toLowerCase() || w.pl.toLowerCase() === pl.toLowerCase())){
        toast('Taka para ju≈º istnieje.'); return;
      }
      words.push({ en, pl });
      qs('#englishInput').value = '';
      qs('#polishInput').value = '';
      toast('Dodano nowƒÖ parƒô s≈Ç√≥w ‚úî');
      renderColumns();
    }

    function shuffleAll(){ renderColumns(); toast('Wymieszano s≈Çowa.'); }

    function hardReset(){
      words = [...initialWords];
      selected = null; removeAllLines(); renderColumns();
      toast('Zestaw zresetowany.');
    }

    // ====== Fullscreen (na ≈ºƒÖdanie) ======
    function toggleFullscreen(){
      const d = document;
      if (!d.fullscreenElement) {
        const el = d.documentElement;
        (el.requestFullscreen || el.webkitRequestFullscreen || el.mozRequestFullScreen || el.msRequestFullscreen).call(el);
      } else {
        (d.exitFullscreen || d.webkitExitFullscreen || d.mozCancelFullScreen || d.msExitFullscreen).call(d);
      }
    }

    // Aktualizacja pozycji linii przy zmianie rozmiaru/przewiniƒôciu
    function syncLines(){ lines.forEach(({ line }) => line.position()); }

    // ====== Motyw: ustawianie i zapisywanie ======
    function applyTheme(theme){
      document.body.setAttribute('data-theme', theme);
      // zaznacz radio
      const light = qs('#theme-light');
      const dark = qs('#theme-dark');
      if (theme === 'light') { light.checked = true; dark.checked = false; }
      else { dark.checked = true; light.checked = false; }
      // od≈õwie≈º kolory istniejƒÖcych linii
      const color = getVar('--line') || 'rgba(229,231,235,.9)';
      lines.forEach(({ line }) => line.setOptions({ color }));
    }

    function initTheme(){
      const saved = localStorage.getItem('theme');
      const preferred = saved || 'dark';
      applyTheme(preferred);
      qs('#theme-light').addEventListener('change', (e)=> {
        if (e.target.checked){ localStorage.setItem('theme','light'); applyTheme('light'); }
      });
      qs('#theme-dark').addEventListener('change', (e)=> {
        if (e.target.checked){ localStorage.setItem('theme','dark'); applyTheme('dark'); }
      });
    }

    // ====== Inicjalizacja ======
    function init(){
      initTheme();           // 1) motyw
      renderColumns();       // 2) render s≈Ç√≥w

      // Zdarzenia UI
      qs('#addBtn').addEventListener('click', addCustomWord);
      qs('#checkBtn').addEventListener('click', checkAnswers);
      qs('#undoBtn').addEventListener('click', undoLast);
      qs('#shuffleBtn').addEventListener('click', shuffleAll);
      qs('#resetBtn').addEventListener('click', hardReset);
      qs('#fullscreenBtn').addEventListener('click', toggleFullscreen);

      // reposition lines on window updates
      window.addEventListener('resize', syncLines);
      window.addEventListener('scroll', syncLines, true);

      // MOBILE UX: podczas pisania linie chowamy, by nic nie zas≈Çania≈Çy
      const hide = () => document.body.classList.add('hide-lines');
      const show = () => document.body.classList.remove('hide-lines');
      const inputs = [qs('#englishInput'), qs('#polishInput')];
      inputs.forEach(i => {
        i.addEventListener('focus', hide);
        i.addEventListener('blur', show);
        i.addEventListener('input', hide);
      });

      // Dodatkowo ‚Äì podczas dotykania/przewijania na mobile
      let touchTimer = null;
      window.addEventListener('touchstart', () => {
        hide();
        if (touchTimer) clearTimeout(touchTimer);
      }, {passive:true});
      window.addEventListener('touchend', () => {
        touchTimer = setTimeout(show, 180);
      }, {passive:true});
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
